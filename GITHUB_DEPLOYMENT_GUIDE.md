# üöÄ GitHub Deployment Guide - PakChain Aid

This guide will help you upload your project to GitHub and deploy it to Azure App Service.

---

## üìã Prerequisites

- ‚úÖ GitHub account (create one at https://github.com if you don't have one)
- ‚úÖ Git installed on your computer
- ‚úÖ Azure App Service already created (`pakchain-aid-api`)

---

## Step 1: Clean Up Project (Already Done ‚úÖ)

The following unnecessary files have been removed:
- ‚úÖ `backend/backend.zip` - Deployment artifact
- ‚úÖ `backend/dist/` - Build output (will be generated by Azure)
- ‚úÖ `backend/node_modules/` - Dependencies (will be installed by Azure)

**Note:** The `.gitignore` files are configured to exclude these automatically.

---

## Step 2: Initialize Git Repository

### 2.1: Open Terminal/CMD in Project Root

Navigate to your project folder:
```cmd
cd "C:\Users\User\Desktop\PAKCHAIN AID\project-bolt-sb1-5xbq1vbq (1)\project"
```

### 2.2: Initialize Git (if not already done)

```cmd
git init
```

### 2.3: Check Git Status

```cmd
git status
```

This shows which files will be committed.

---

## Step 3: Create GitHub Repository

### 3.1: Go to GitHub

1. Open https://github.com in your browser
2. Sign in to your account

### 3.2: Create New Repository

1. Click the **"+"** icon in the top right ‚Üí **"New repository"**
2. Fill in:
   - **Repository name**: `pakchain-aid` (or your preferred name)
   - **Description**: "PakChain Aid - Blockchain-based donation platform"
   - **Visibility**: Choose **Public** or **Private**
   - **DO NOT** check "Initialize with README" (we already have files)
   - **DO NOT** add .gitignore or license (we already have them)
3. Click **"Create repository"**

### 3.3: Copy Repository URL

After creating, GitHub will show you commands. Copy the repository URL:
- It will look like: `https://github.com/your-username/pakchain-aid.git`
- Or SSH: `git@github.com:your-username/pakchain-aid.git`

---

## Step 4: Add Files to Git

### 4.1: Add All Files

```cmd
git add .
```

### 4.2: Check What Will Be Committed

```cmd
git status
```

Verify that:
- ‚úÖ `src/` folder is included
- ‚úÖ `backend/src/` folder is included
- ‚úÖ `package.json` files are included
- ‚úÖ `tsconfig.json` files are included
- ‚ùå `node_modules/` is NOT included
- ‚ùå `dist/` is NOT included
- ‚ùå `.env` is NOT included

### 4.3: Create Initial Commit

```cmd
git commit -m "Initial commit: PakChain Aid project with backend API"
```

---

## Step 5: Connect to GitHub and Push

### 5.1: Add GitHub Remote

Replace `your-username` and `pakchain-aid` with your actual values:

```cmd
git remote add origin https://github.com/your-username/pakchain-aid.git
```

### 5.2: Rename Branch to Main (if needed)

```cmd
git branch -M main
```

### 5.3: Push to GitHub

```cmd
git push -u origin main
```

**If prompted for credentials:**
- **Username**: Your GitHub username
- **Password**: Use a **Personal Access Token** (not your GitHub password)
  - Create one at: https://github.com/settings/tokens
  - Click "Generate new token (classic)"
  - Select scopes: `repo` (full control)
  - Copy the token and use it as password

---

## Step 6: Configure Azure App Service for GitHub Deployment

### 6.1: Go to Azure Portal

1. Open https://portal.azure.com
2. Navigate to your App Service: `pakchain-aid-api`

### 6.2: Open Deployment Center

1. In the left menu, click **"Deployment Center"**
2. Click **"Settings"** tab

### 6.3: Configure GitHub Source

1. **Source**: Select **"GitHub"**
2. Click **"Authorize"** and sign in to GitHub
3. **Organization**: Select your GitHub username
4. **Repository**: Select `pakchain-aid` (or your repo name)
5. **Branch**: Select `main` (or your default branch)
6. **Build provider**: Select **"App Service build service"**
7. **Runtime stack**: Select **"Node 20 LTS"** (or 18 LTS)
8. **Version**: Select the latest version
9. Click **"Save"**

### 6.4: Wait for Deployment

Azure will:
1. Clone your repository
2. Run `npm install` in the backend folder
3. Run `npm run build` to compile TypeScript
4. Run `npm start` to start the app

This takes 3-5 minutes. You can monitor progress in **Deployment Center ‚Üí Logs**.

---

## Step 7: Verify Deployment

### 7.1: Check Deployment Status

1. Go to **Deployment Center ‚Üí Logs**
2. Look for "Deployment successful"

### 7.2: Test Your API

Open in browser:
```
https://pakchain-aid-api-b9g0dycsaafegfft.centralus-01.azurewebsites.net/health
```

Should return: `{"status":"ok","timestamp":"..."}`

### 7.3: Check Application Logs

```cmd
az webapp log tail --name pakchain-aid-api --resource-group pakchain-aid-resources
```

Look for: `Server running on port...`

---

## Step 8: Configure Build Settings (Important!)

Azure needs to know to build and run from the `backend` folder, not the root.

### 8.1: Set Application Path

1. Go to **Azure Portal ‚Üí `pakchain-aid-api` ‚Üí Configuration**
2. Click **"General settings"** tab
3. Find **"Application path"** or **"Working Directory"**
4. Set it to: `/backend`
5. Click **"Save"**

### 8.2: Set Startup Command

1. In the same **"General settings"** tab
2. Find **"Startup Command"**
3. Set it to: `npm start`
4. Click **"Save"**

**Note:** The `postinstall` script in `package.json` will automatically run `npm run build` after `npm install`, so the TypeScript will be compiled automatically.

### 8.3: Verify Configuration Files

The following files are already created in your repo:
- ‚úÖ `backend/.deployment` - Tells Azure to build during deployment
- ‚úÖ `backend/package.json` - Has `postinstall` script to auto-build

These ensure Azure will:
1. Navigate to `/backend` folder
2. Run `npm install` (installs dependencies)
3. Run `npm run build` (compiles TypeScript via postinstall)
4. Run `npm start` (starts the server)

---

## üîÑ Future Updates

After making changes to your code:

1. **Commit changes**:
   ```cmd
   git add .
   git commit -m "Description of changes"
   git push origin main
   ```

2. **Azure will automatically deploy** the new version (takes 3-5 minutes)

3. **Monitor deployment** in Azure Portal ‚Üí Deployment Center ‚Üí Logs

---

## ‚ö†Ô∏è Troubleshooting

### Issue: Build fails

**Solution**: Check Azure Portal ‚Üí Deployment Center ‚Üí Logs for errors

### Issue: App doesn't start

**Solution**: 
1. Check environment variables are set
2. Check startup command is correct
3. Check logs: `az webapp log tail --name pakchain-aid-api --resource-group pakchain-aid-resources`

### Issue: Cannot push to GitHub

**Solution**: 
- Use Personal Access Token instead of password
- Check repository URL is correct
- Verify you have write access to the repository

---

## ‚úÖ Checklist

Before deploying, ensure:
- [ ] All code is committed to Git
- [ ] Repository is pushed to GitHub
- [ ] Azure App Service is connected to GitHub
- [ ] Environment variables are set in Azure Portal
- [ ] Startup command is configured
- [ ] SQL Server firewall allows Azure services

---

## üìû Next Steps

After successful deployment:
1. Test all API endpoints
2. Update frontend to use the new API URL
3. Set up custom domain (optional)
4. Configure CI/CD for automatic deployments

---

**Last Updated**: 2025-11-28

